import MediaModal from '../base-modal/index.js';
import { loadExternalResource, applyTemplate, svgToDataUrl } from '../utils/index.js';

const svg = `
<svg
   width="200"
   height="200"
   viewBox="0 0 49.025279 49.025279"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer2"
     style="fill:none;stroke:none"><path
       id="path1"
       style="fill:#000000;stroke:none;stroke-width:0.245126;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;paint-order:fill markers stroke"
       d="M 24.512639,0.24752021 A 24.265341,24.265341 0 0 0 0.24752021,24.512639 24.265341,24.265341 0 0 0 24.512639,48.777759 24.265341,24.265341 0 0 0 48.777759,24.512639 24.265341,24.265341 0 0 0 24.512639,0.24752021 Z m 2.265983,1.61390839 c 4.656939,0.1365519 8.222746,2.426847 8.222746,2.426847 -2.33539,-1.2828623 -4.611604,-0.9142664 -4.860875,-0.2910876 -0.249271,0.6231786 0.706287,1.038864 1.12174,1.2050452 0.415453,0.1661806 2.077532,-0.2490575 3.448526,0.083305 1.370994,0.332362 2.658631,2.1603651 3.240265,3.9052656 0.581635,1.7448992 2.284874,3.2820742 3.115786,3.1574382 0.830902,-0.124636 -2.658568,-3.5313517 -2.658568,-3.5313517 1.080177,0.5400877 2.866261,2.0770047 3.946439,3.6141777 0.716986,1.020325 1.329411,4.486919 1.287871,5.027006 -0.04154,0.540089 0.290316,5.546778 1.495654,5.525398 0.969797,-0.01721 0.588705,-2.646045 -0.996783,-5.317615 -0.568936,-0.958666 -0.119905,-4.459679 -0.202995,-4.833586 -0.08309,-0.373908 -0.628239,-0.691767 -0.669789,-1.231856 -0.09247,-1.201975 -3.448048,-4.6119186 -3.448048,-4.6119186 1.287902,0.4569978 4.457333,4.6290276 4.665062,6.6231996 0.207724,1.994172 1.608491,3.887898 2.107034,5.508163 0.498545,1.620265 0.242179,3.726915 -1.08727,4.557819 -0.624402,0.39025 -0.983496,-0.04752 -1.681414,0.842143 -0.518588,0.661062 0.297321,2.485284 -0.779904,3.273778 -1.51788,1.111034 -0.979959,3.04185 -0.02442,3.332666 0.955541,0.290818 0.747832,-1.495559 1.121741,-2.201829 0.373907,-0.706267 1.407051,-0.866207 1.620132,-2.284655 0.361163,-2.404145 0.841728,-2.889924 1.030297,-2.993223 -0.44654,0.317676 -0.726649,2.333321 -0.531905,3.034397 0.207725,0.747816 0.623488,2.700825 -0.62287,3.864092 -1.246356,1.163268 -2.402792,2.487285 -1.61343,2.902737 0.78936,0.415453 1.363995,-1.822649 1.363995,-1.822649 -0.192604,0.861147 0.217819,1.011034 -0.903904,3.753019 -1.12172,2.741987 -3.832026,3.808249 -4.579842,4.431426 -0.747813,0.623178 -0.20598,0.966896 -0.24752,1.426233 -0.05822,0.643666 -0.517347,-0.262444 -1.751792,2.747139 -0.631032,1.538462 -5.080628,2.450307 -5.080628,2.450307 5.229095,-1.586351 4.347734,-3.054944 5.229044,-3.877498 0.881302,-0.822555 0.763665,-1.410165 -0.05889,-1.292658 -0.822554,0.117509 -0.857786,3.227671 -3.290055,4.230345 -1.910366,0.787526 -3.23846,-0.18471 -3.545715,-0.708568 -0.403851,-0.688553 -0.861396,-1.587655 -2.212362,-0.718623 -2.966095,1.907987 -4.758899,1.603376 -4.758899,1.603376 4.155033,-0.648127 3.615436,-2.464171 5.848084,-2.875448 2.232644,-0.411276 1.615571,1.372881 2.550846,1.431021 1.74942,0.108756 1.297678,-1.039529 2.249227,-1.383145 1.495636,-0.54009 1.315024,-0.863029 1.557893,-1.038435 0.373908,-0.270043 1.661905,-0.748042 1.059501,-0.831132 -2.256064,-0.311185 -3.905266,1.495654 -3.905266,1.495654 1.578717,-2.534257 4.071521,-1.910746 5.23479,-2.284655 1.163266,-0.373907 1.620063,-1.911332 0.664522,-2.326785 -0.955541,-0.415452 -1.620132,0.623348 -1.620132,0.623348 -0.04155,-0.456999 0.7063,-1.121628 1.869567,-1.080088 1.163265,0.04155 1.121526,-0.415788 1.038436,-0.872784 -0.0831,-0.456998 -0.913838,-1.079999 -0.124478,-2.160176 0.78936,-1.080176 0.248956,-2.617395 0.248956,-2.617395 0.415453,0.290818 0.664838,1.246288 0.415566,2.201829 -0.249271,0.955541 -0.04133,2.285246 0.457218,2.326786 0.498542,0.04154 2.658587,-0.748003 0.62287,-4.902528 -2.035715,-4.154524 0.103892,-5.587637 0.103892,-5.587637 -0.581642,0.498545 -1.184024,2.36791 -0.643936,2.53409 0.540088,0.166182 0.394819,-0.602619 0.519457,-1.475068 0.124635,-0.872452 1.267379,-1.393606 0.56111,-1.993567 -0.313448,-0.266268 -3.528744,0.507775 -4.078578,4.130284 -1.242248,8.184393 -3.877497,8.81306 -3.877497,8.81306 3.23146,-1.909499 2.456717,-9.895919 4.083365,-11.868522 2.031769,-2.463885 3.978407,0.56102 4.611919,-5.376024 0.553281,-5.185134 -4.415263,-7.017015 -5.229044,-8.96004 -2.429776,-5.8014566 -4.054138,-5.9929376 -5.934261,-6.1104452 -1.880125,-0.1175077 -4.52747,0.5933304 -4.56117,2.7169771 -0.02519,1.5874871 4.678946,1.7484407 4.678946,1.7484407 -5.608397,-0.324011 -5.949047,2.3723864 -7.285329,0.4701444 -1.363164,-1.9405087 -2.585317,-0.9603972 -2.585317,-0.9603972 1.886029,-1.4041879 2.764239,1.0019922 4.17433,0.7669772 1.410094,-0.2350148 1.36135,-2.0393739 -1.119347,-2.3918971 -2.929339,-0.4162782 -6.296684,2.1510798 -6.296684,2.1510798 0.59484,-0.8694101 3.133019,-2.3206051 4.12406,-2.5862749 0.81982,-0.2197703 3.424212,0.3809437 3.465762,-2.277952 C 27.107904,2.4600329 21.341039,3.8426446 20.16978,4.8699724 19.467899,5.4856008 18.637412,5.8721796 18.138869,5.747544 17.640326,5.6229081 18.488686,4.7744987 17.760168,4.7866677 c -0.583034,0.00974 -0.374177,0.5817654 -0.291087,1.5373063 0.08309,0.9555414 -2.076992,0.8724116 -2.866351,0.9139576 -0.78936,0.041545 -0.706181,0.7893785 -1.080088,1.1217405 -0.373907,0.3323619 -3.448256,1.6620059 -3.157439,2.1190029 0.290817,0.456997 0.996803,-0.457388 2.118524,-1.080567 1.121722,-0.623179 3.07426,-1.2877517 4.237527,-0.4983918 0.740518,0.5024952 1.745089,0.1661306 1.745089,0.1661306 -0.997086,0.6231784 -2.077314,-0.2906088 -2.991308,-0.2906088 -0.913996,0 -4.229515,2.121544 -5.42007,2.248268 -1.0060116,0.107079 -1.1854602,2.114101 -0.645372,1.69865 0.540089,-0.415458 2.284925,-0.581855 2.575742,-0.457219 0.290818,0.124636 1.13e-4,-0.45684 0.415566,-0.124478 0.415452,0.332362 2.53409,1.038555 2.53409,1.827915 0,0.544208 -0.502649,0.819471 -0.821557,0.945556 -0.03817,0.06749 -0.104899,0.104698 -0.258531,0.09288 0,0 0.114872,-0.03608 0.258531,-0.09288 0.09601,-0.169777 -0.008,-0.551001 0.496477,-0.971409 0.705047,-0.587538 -1.945249,-1.056954 -2.591541,-1.409477 -0.646292,-0.352523 -1.444453,-0.06888 -2.2262458,0.469666 -0.511993,0.352693 -0.8655523,0.0059 -0.9608763,0.539087 -0.075963,0.424922 0.7458226,0.02782 1.2792531,1.144242 0.801021,1.676455 -1.8417391,2.65426 -3.07557,2.65426 -1.2338309,0 -2.0020822,0.133986 -2.1707091,2.571912 -0.080095,1.157974 1.2314031,2.057016 1.4377238,2.710274 0.5065928,1.603988 0.3562307,2.017799 -0.2700221,2.101289 -0.8813077,0.117509 -0.7051202,-0.998603 -1.2926587,-0.851719 -1.7605415,0.440134 0.1077266,6.441784 1.1753619,6.110446 0.8519307,-0.264394 -1.2634542,-4.612398 -1.2634542,-4.612398 0.7637999,0.910685 1.6452575,2.585047 1.8508958,3.201964 0.3664458,1.099341 1.2338876,3.525452 0.2350724,3.877976 -0.9988156,0.352524 -1.8802911,-3.172897 -2.1740605,-3.231647 -0.2937692,-0.05875 -0.4699354,1.293019 0.1469801,3.026258 0.7171489,2.014847 2.8494734,3.201731 5.3171366,3.730517 2.467662,0.528785 6.991692,5.581568 7.344216,6.697887 0.352522,1.116322 3.015586,4.180786 4.582715,3.877976 2.41726,-0.467077 3.300413,-0.0833 4.064215,-0.0833 0.763801,0 2.810335,-0.563025 2.810335,-0.563025 -0.47003,0.176264 -1.781637,0.93113 -4.876674,1.233771 -4.686244,0.458233 -7.226957,-4.230151 -7.87325,-5.405228 -0.646292,-1.175077 -3.23105,-3.349269 -4.229866,-3.701792 -0.998816,-0.352522 -2.872357,-0.42177 -0.764105,0.940289 4.778326,3.087091 4.817787,6.286631 4.817787,6.286631 0,0 -0.631508,-3.880183 -6.2866304,-6.580591 C 3.8564232,35.927524 3.0357358,27.22102 3.6232745,25.340899 4.210813,23.460775 3.9756069,21.404386 3.3293144,21.345626 c -0.6462925,-0.05875 -0.1934768,4.514135 -0.4284925,5.51295 -0.2350153,0.998817 0.7779891,5.125631 0.7779891,5.125631 -3.98222888,-10.490873 0.9429884,-18.80544 1.7067883,-18.8642 0.7638001,-0.05875 1.8216912,-1.762803 1.8216912,-1.762803 -0.1175075,0.940061 -1.527691,2.70267 -2.350245,2.937686 -0.8225538,0.235015 -0.8811738,2.879278 0.058888,2.879278 0.9400616,0 0.7049292,-1.645142 0.9986986,-2.115173 C 6.208401,14.588964 6.3845457,14.941431 6.9133304,14.823923 7.442115,14.706415 7.4488346,13.455217 7.9776194,13.278956 8.5064043,13.102695 9.0248031,11.934161 8.8556698,11.599458 8.5354857,10.965837 7.2072905,12.767638 7.2072905,12.767638 7.7159141,11.46375 8.4409645,11.239927 9.028503,10.82865 9.6160412,10.417373 9.0543562,9.3305629 9.7337202,7.7147788 10.820667,5.1296097 14.332713,5.077755 14.332713,5.077755 12.579566,5.4575674 12.587488,5.7629491 12.44208,6.0745385 c -0.145408,0.3115891 -0.136592,0.6992583 0.735858,0.6161673 0.87245,-0.08309 0.282801,0.2149138 1.383144,0.3810949 0.757466,0.1143975 2.288381,-0.6396424 2.375141,-1.9792041 0.05789,-0.8938343 3.856432,-2.1338444 3.856432,-2.1338444 -1.700045,0.7050462 -2.368011,1.0802583 -2.201829,1.7034369 0.16618,0.6231788 2.492311,-0.6904673 3.233562,-0.874699 2.23387,-0.5552089 4.816921,-0.1433873 4.909231,-0.7870856 0.220345,-1.5365397 -4.569788,-0.4983917 -4.569788,-0.4983917 1.254795,-0.4050662 2.490282,-0.595781 3.669714,-0.6377117 0.31943,-0.011356 0.634615,-0.011976 0.945077,-0.00287 z M 25.641083,13.035745 c 0.789372,0.01385 1.163274,0.103804 1.675668,0.256138 0.512395,0.152333 1.16316,0.367044 1.67902,0.581696 0.51586,0.214652 0.896843,0.429434 1.177277,0.609465 0.280435,0.180032 0.460107,0.325468 0.698994,0.522809 0.238886,0.197341 0.536742,0.446371 0.834483,0.695642 -0.221575,-0.18003 -0.442946,-0.359946 -0.664523,-0.467273 -0.221577,-0.107327 -0.443209,-0.141712 -0.581696,-0.141713 -0.138483,0 -0.193736,0.03454 -0.183366,0.107243 0.01039,0.0727 0.08626,0.183348 0.205389,0.281033 0.119133,0.09768 0.281327,0.182086 0.358114,0.222146 0.07679,0.04006 0.523262,0.458888 0.770808,0.710005 0.247546,0.251116 0.524592,0.549115 0.753093,0.819162 0.228502,0.270047 0.408368,0.512213 0.588399,0.813418 0.180032,0.301206 0.360492,0.661062 0.540523,1.038436 0.180032,0.377373 0.360016,0.772399 0.495041,1.066682 0.135023,0.294283 0.225042,0.488022 0.373913,0.737295 0.148871,0.249273 0.356555,0.554135 0.495041,0.682236 0.138486,0.128103 0.207599,0.0796 0.228369,-0.05889 0.02077,-0.138484 -0.0072,-0.367376 -0.05219,-0.571642 -0.04501,-0.204266 -0.107084,-0.384133 -0.186717,-0.588399 -0.07963,-0.204266 -0.176505,-0.43289 -0.301142,-0.654468 -0.124637,-0.221577 -0.277076,-0.436129 -0.460569,-0.706175 -0.183494,-0.270047 -0.397911,-0.595294 -0.560631,-0.903425 -0.162722,-0.30813 -0.27366,-0.599203 -0.339443,-0.845016 -0.06578,-0.245812 -0.08647,-0.446485 -0.107243,-0.647287 0.110788,0.26312 0.226203,0.537885 0.279119,0.663565 0.05292,0.125682 0.360297,0.768262 0.497434,1.007795 0.137139,0.239532 0.261796,0.40601 0.41413,0.59989 0.152333,0.19388 0.332466,0.415506 0.505573,0.671703 0.173107,0.256199 0.339429,0.547019 0.474454,0.792831 0.135023,0.245813 0.238965,0.446535 0.356678,0.900074 0.117712,0.453537 0.249243,1.159875 0.315025,1.74844 0.06582,0.588565 0.06573,1.059132 0.06224,1.474589 -0.0035,0.415458 -0.01064,0.775527 -0.05219,1.12174 -0.04154,0.346214 -0.117692,0.678704 -0.225018,1.073386 -0.107326,0.394683 -0.245467,0.851755 -0.378222,1.239037 -0.132755,0.387283 -0.259882,0.704763 -0.319814,0.854591 -0.05993,0.149829 -0.143261,0.772808 -0.184802,1.084397 -0.01385,-0.290816 -0.02839,-0.595439 -0.03495,-0.733943 -0.0066,-0.138502 0.0788,-0.365996 0.119212,-0.525681 0.04041,-0.159685 0.08186,-0.37441 0.126872,-0.568291 0.04501,-0.19388 0.09375,-0.366752 0.156077,-0.560631 0.06232,-0.19388 0.138398,-0.408511 0.19725,-0.643935 0.05886,-0.235424 0.100465,-0.491587 0.117776,-0.823951 0.01731,-0.332364 0.01042,-0.741199 -0.03112,-1.142806 -0.04154,-0.401608 -0.117763,-0.796077 -0.252787,-1.128443 -0.135022,-0.332365 -0.329118,-0.60231 -0.457218,-0.706175 -0.128103,-0.103862 -0.190397,-0.04196 -0.225018,0.07229 -0.03462,0.114252 -0.04124,0.280636 -0.02346,0.519458 0.01778,0.238822 0.0601,0.550105 0.07995,0.695642 0.01985,0.145538 0.131886,0.817082 0.186717,1.208396 0.05484,0.391315 0.10994,0.84833 0.116818,1.2534 0.0069,0.405072 -0.03455,0.75815 -0.153204,1.266806 -0.118651,0.508656 -0.314281,1.173118 -0.409342,1.495654 -0.09506,0.322536 -0.249682,0.771823 -0.349018,0.983378 -0.09934,0.211556 -0.223902,0.418936 -0.348539,0.612816 -0.124637,0.19388 -0.249332,0.374113 -0.354763,0.532384 -0.105428,0.158272 -0.191386,0.29489 -0.229806,0.355721 -0.03842,0.06083 -0.119427,0.303692 -0.141235,0.369125 -0.02181,0.06543 0.07794,0.0083 0.156077,-0.08091 0.07814,-0.08916 0.188917,-0.241209 0.299705,-0.393543 0.110789,-0.152334 0.22175,-0.304846 0.320292,-0.445728 0.09854,-0.140883 0.184758,-0.270423 0.223104,-0.327952 0.03835,-0.05753 0.218309,-0.445271 0.308323,-0.639148 -0.02077,0.13156 -0.04027,0.25672 -0.127351,0.450515 -0.08709,0.193794 -0.239662,0.44287 -0.395458,0.681758 -0.155796,0.238888 -0.31475,0.467326 -0.510361,0.697557 -0.19561,0.230232 -0.427817,0.462288 -0.538608,0.573079 -0.110789,0.110789 -1.277267,0.985738 -1.673753,1.278774 -0.396486,0.293037 -0.611138,0.445383 -0.843101,0.590793 -0.231963,0.14541 -0.481241,0.284018 -0.73873,0.412693 -0.257489,0.128677 -0.523093,0.247273 -0.652075,0.304972 -0.128982,0.0577 -0.711976,0.182678 -1.015934,0.192941 -0.303959,0.01023 -0.622585,-0.03115 -0.930714,-0.045 -0.30813,-0.01385 -0.606122,-3.36e-4 -0.801449,0.0316 -0.195326,0.03193 -0.288233,0.08217 -0.330346,0.104849 -0.04212,0.02268 -0.308168,0.190902 -0.569727,0.22454 -0.26156,0.03365 -0.656354,0.01947 -0.971409,0.0091 -0.315056,-0.0104 -0.550261,-0.01709 -0.799534,-0.02059 -0.249273,-0.0035 -0.512547,-0.0033 -0.758359,-0.02059 -0.245812,-0.01731 -0.474247,-0.05196 -0.720059,-0.103892 -0.245812,-0.05193 -0.508979,-0.121238 -0.716708,-0.162779 -0.207728,-0.04155 -0.360163,-0.05527 -0.505573,-0.138362 -0.14541,-0.08309 -0.283526,-0.235729 -0.415087,-0.304972 -0.13156,-0.06924 -0.256384,-0.05539 -0.39833,-0.09001 -0.141948,-0.03462 -0.301101,-0.117584 -0.444771,-0.230284 -0.143669,-0.112702 -0.271951,-0.254869 -0.330824,-0.320292 -0.05888,-0.06542 -0.267658,-0.107331 -0.391628,-0.183366 -0.123972,-0.07603 -0.269345,-0.207771 -0.425141,-0.342794 -0.155796,-0.135024 -0.321961,-0.273214 -0.472539,-0.399288 -0.150578,-0.126073 -0.285685,-0.24 -0.34806,-0.292524 -0.06237,-0.05252 -0.369365,-0.177938 -0.54962,-0.264756 -0.180254,-0.08682 -0.391181,-0.199407 -0.492167,-0.253265 -0.100991,-0.05386 -0.574967,-0.430441 -0.791395,-0.619519 -0.216429,-0.189079 -0.417332,-0.382568 -0.584569,-0.676491 -0.167236,-0.293925 -0.300661,-0.687985 -0.364338,-0.875657 -0.06367,-0.187672 -0.22253,-0.677338 -0.257574,-0.785649 -0.03505,-0.108311 -0.03495,-0.551627 -0.03495,-0.773202 0.03462,0.193878 0.07056,0.394481 0.142671,0.661171 0.07211,0.266691 0.182689,0.612894 0.338485,0.969495 0.155796,0.3566 0.356844,0.723752 0.56111,0.997262 0.204266,0.273509 0.411759,0.45345 0.560631,0.571163 0.148872,0.117713 0.239078,0.172978 0.353327,0.22837 0.114248,0.05539 0.25292,0.110847 0.39833,0.162779 0.145411,0.05193 0.297556,0.100315 0.3945,0.152247 0.09694,0.05193 0.138537,0.107682 0.252787,0.183845 0.114251,0.07617 0.30116,0.173113 0.49504,0.328909 0.193881,0.155797 0.394519,0.37015 0.538129,0.509883 0.14361,0.139735 0.230367,0.204493 0.268586,0.233157 0.03822,0.02866 0.425338,0.01506 0.589835,0.06128 0.164499,0.04622 0.299474,0.145467 0.361945,0.191505 0.06248,0.04604 0.245522,0.327878 0.340879,0.418918 0.09536,0.09104 0.199188,0.139506 0.34806,0.163736 0.148871,0.02423 0.343185,0.02434 0.495519,0.04165 0.152335,0.01731 0.262904,0.05188 0.380617,0.121127 0.117712,0.06924 0.242534,0.172969 0.39833,0.273373 0.155795,0.100402 0.34237,0.197428 0.550098,0.266671 0.207728,0.06924 0.436571,0.11078 0.692769,0.135011 0.256199,0.02428 0.540167,0.03112 0.820599,0.03112 0.280434,0 0.557113,-0.0068 0.771765,-0.04836 0.214652,-0.04154 0.366977,-0.117583 0.463921,-0.183366 0.09694,-0.06578 0.138678,-0.121564 0.128309,-0.152725 -0.01039,-0.03116 -0.07309,-0.038 -0.197729,-0.03112 -0.124636,0.0069 -0.311322,0.02777 -0.546747,0.02777 -0.235425,0 -0.519468,-0.0207 -0.803364,-0.06224 -0.283895,-0.04154 -0.567674,-0.104063 -0.818683,-0.237467 -0.25101,-0.133403 -0.468889,-0.337666 -0.583133,-0.44477 -0.114244,-0.107104 -0.429512,-0.340305 -0.586963,-0.500786 -0.15745,-0.160481 -0.310152,-0.361265 -0.462485,-0.562067 0.08309,0.09002 0.166265,0.180063 0.320293,0.316462 0.154028,0.136399 0.379022,0.319207 0.486422,0.40647 0.107401,0.08726 0.533245,0.4564 0.631967,0.541959 0.09873,0.08556 0.323213,0.204564 0.552013,0.238424 0.228799,0.03386 0.578207,0.04445 0.851718,0.01676 0.273512,-0.02769 0.473053,-0.09432 0.570685,-0.126872 0.09763,-0.03254 0.251645,-0.144238 0.351891,-0.20108 0.100244,-0.05685 0.226278,-0.116263 0.287257,-0.145065 0.06098,-0.02878 0.261735,-0.02917 0.388755,0.0057 0.127021,0.03492 0.28086,0.104812 0.355721,0.138841 0.07486,0.03403 0.267871,-0.01403 0.382531,-0.04357 0.11466,-0.02953 0.246173,-0.06445 0.490253,-0.08522 0.24408,-0.02078 0.600779,-0.02755 0.946992,-0.02585 0.346214,0.0017 0.681879,0.01208 0.962313,-0.01388 0.280433,-0.02596 0.505381,-0.08807 0.765541,-0.166131 0.26016,-0.07806 0.555723,-0.171896 0.701866,-0.218316 0.146143,-0.04642 0.673477,-0.268723 0.93598,-0.406948 0.262503,-0.138224 0.525696,-0.304329 0.764584,-0.496476 0.238888,-0.192149 0.453458,-0.410175 0.642978,-0.627658 0.189521,-0.217483 0.353583,-0.434442 0.43328,-0.539565 0.0797,-0.105129 0.278626,-0.367747 0.324601,-0.428493 0.04597,-0.06075 0.223765,-0.359141 0.264756,-0.428013 0.04099,-0.06887 0.215675,-0.404026 0.259968,-0.529033 0.0443,-0.125006 0.04747,-0.211496 0.03016,-0.259968 -0.01732,-0.04847 -0.05509,-0.059 -0.136447,-0.03304 -0.08136,0.02597 -0.206077,0.08816 -0.334177,0.183366 -0.1281,0.09521 -0.25951,0.223605 -0.430886,0.39498 -0.171375,0.171375 -0.38281,0.385868 -0.538608,0.543395 -0.155796,0.157528 -0.256247,0.257782 -0.35572,0.380137 -0.09948,0.122355 -0.197784,0.266994 -0.244648,0.335613 -0.04686,0.06861 -0.41579,0.562202 -0.598453,0.763626 -0.182664,0.201423 -0.36583,0.360791 -0.573557,0.494083 -0.207729,0.133292 -0.439816,0.240326 -0.654469,0.307844 -0.214652,0.06751 -0.412124,0.09533 -0.586963,0.08666 -0.174838,-0.0087 -0.327314,-0.05362 -0.406948,-0.121127 -0.07963,-0.06751 -0.08623,-0.157353 -0.03878,-0.300663 0.04744,-0.143308 0.148939,-0.340023 0.197728,-0.434237 0.04879,-0.09421 0.244575,-0.268612 0.347582,-0.350933 0.103005,-0.08232 0.21399,-0.162227 0.320292,-0.22837 0.106302,-0.06614 0.207827,-0.118871 0.256617,-0.144107 0.04879,-0.02524 0.216705,-0.150835 0.337049,-0.266192 0.120342,-0.115358 0.279768,-0.285182 0.439025,-0.454825 l -0.405033,0.542917 c -0.08302,0.111283 -0.29957,0.334731 -0.352369,0.389234 -0.0528,0.0545 -0.400586,0.31187 -0.489774,0.451473 -0.08919,0.139604 -0.09645,0.291897 -0.06703,0.37152 0.02943,0.07962 0.09538,0.08673 0.226933,0.04692 0.131559,-0.03981 0.329037,-0.126197 0.564461,-0.259489 0.235426,-0.133292 0.509028,-0.313317 0.766978,-0.518978 0.257949,-0.20566 0.500282,-0.436926 0.641063,-0.613774 0.14078,-0.176847 0.179916,-0.29968 0.257095,-0.401682 0.07718,-0.102002 0.192202,-0.183199 0.253265,-0.226454 0.06106,-0.04325 0.822346,-0.717149 1.100197,-1.016892 0.277851,-0.299744 0.449227,-0.55923 0.593665,-0.838313 0.144438,-0.279083 0.261946,-0.577321 0.345188,-0.969015 0.08324,-0.391694 0.132521,-0.87676 0.151768,-1.194991 0.01926,-0.318232 0.0084,-0.469707 -0.01293,-0.63867 -0.02136,-0.168962 -0.05523,-0.384443 -0.133575,-0.751657 -0.07834,-0.367214 -0.200922,-0.886214 -0.381095,-1.381229 -0.180173,-0.495015 -0.418115,-0.966072 -0.540044,-1.207439 -0.121928,-0.241369 -0.279914,-0.735363 -0.318377,-0.855549 -0.03846,-0.120187 -0.147284,-0.614673 -0.154161,-0.849803 -0.0068,-0.235132 0.03232,-0.465211 0.06942,-0.690376 0.0371,-0.225165 0.07219,-0.445239 0.08857,-0.548183 0.01637,-0.102943 -0.01366,-0.372064 -0.03543,-0.518979 -0.02177,-0.146913 -0.05084,-0.313696 -0.08857,-0.440461 -0.03773,-0.126766 -0.08388,-0.213555 -0.103892,-0.25135 -0.02001,-0.03778 -0.123119,-0.07931 -0.145065,-0.08809 -0.02194,-0.0088 -0.100526,-0.0084 -0.144586,0.0014 -0.04406,0.0098 -0.09264,0.02908 -0.146501,0.07804 -0.05386,0.04896 -0.11264,0.127525 -0.171397,0.205868 0.05875,-0.102819 0.117427,-0.205837 0.176184,-0.271937 0.05875,-0.0661 0.11731,-0.09527 0.202996,-0.117297 0.08568,-0.02203 0.198325,-0.03695 0.301141,0.0316 0.102821,0.06855 0.196102,0.220554 0.277683,0.391628 0.08158,0.171074 0.151638,0.361325 0.184323,0.450037 0.03269,0.08872 0.101956,0.396765 0.131181,0.551055 0.02923,0.154291 0.05458,0.315674 0.06607,0.389234 0.01149,0.07356 0.120712,0.470013 0.188633,0.619519 0.06792,0.149507 0.150873,0.257344 0.234115,0.289172 0.08324,0.03183 0.16674,-0.01225 0.225497,-0.107721 0.05876,-0.09548 0.09284,-0.24223 0.09527,-0.416045 0.0025,-0.173815 -0.02673,-0.374547 -0.09527,-0.6267 -0.06855,-0.252154 -0.176658,-0.556021 -0.306408,-0.871826 -0.129749,-0.315805 -0.281424,-0.643735 -0.47972,-0.976676 -0.198296,-0.332941 -0.443153,-0.670708 -0.732028,-0.996305 -0.288875,-0.325596 -0.621746,-0.639255 -0.996305,-0.871826 -0.37456,-0.23257 -0.790565,-0.384071 -1.216535,-0.508925 -0.425971,-0.124854 -0.86156,-0.222978 -1.216536,-0.271937 -0.354975,-0.04897 -0.629183,-0.04898 -0.905819,-0.0857 -0.276635,-0.03672 -0.555875,-0.109774 -0.964706,-0.146501 -0.408831,-0.03668 -0.947288,-0.03703 -1.236165,-0.0077 -0.288906,0.02938 -0.328232,0.08827 -0.29396,0.16661 0.03427,0.07834 0.142088,0.176018 0.258053,0.252308 0.115966,0.07629 0.240303,0.131377 0.299705,0.157512 0.0594,0.02614 0.568648,0.06528 0.906298,0.07995 0.33765,0.01467 0.75908,0.02415 1.180149,0.03399 -0.328042,0.0098 -0.656152,0.01972 -1.055192,0.03686 -0.39904,0.01711 -0.869309,0.04134 -1.263454,0.01197 -0.394146,-0.02938 -0.712116,-0.112148 -0.983857,-0.214965 -0.271741,-0.10282 -0.496994,-0.22569 -0.64633,-0.389712 -0.149382,-0.164024 -0.223029,-0.369643 -0.139798,-0.518979 0.08323,-0.149334 0.323225,-0.242348 0.665958,-0.259489 0.342734,-0.01714 0.788364,0.04181 1.273509,0.117775 0.485145,0.07597 1.010006,0.169077 1.271114,0.215443 0.261108,0.04637 1.145003,0.213341 1.363994,0.254702 0.218991,0.04136 0.984194,0.266855 1.235686,0.288694 0.251491,0.02184 0.37359,-0.04634 0.388277,-0.158949 0.01469,-0.112612 -0.07827,-0.269672 -0.283907,-0.458176 -0.205638,-0.188502 -0.523727,-0.408414 -0.849324,-0.579781 -0.325597,-0.171368 -0.658666,-0.293862 -1.030776,-0.384447 -0.37211,-0.09059 -0.783513,-0.149579 -1.16052,-0.161821 -0.377008,-0.01224 -0.719407,0.02214 -0.986251,0.01484 -0.266844,-0.0073 -0.458088,-0.05642 -0.656383,-0.102934 -0.198296,-0.04651 -0.403641,-0.09042 -0.660692,-0.114903 -0.257051,-0.02453 -0.565891,-0.02947 -0.835441,-0.01963 -0.269549,0.0098 -0.499706,0.03425 -0.614252,0.04644 -0.114547,0.01219 -0.557555,0.268161 -0.634839,0.336091 -0.07728,0.06793 -0.01386,0.07771 0.04979,0.114425 0.06365,0.03672 0.127482,0.100458 0.186239,0.169003 0.05875,0.06855 0.112869,0.142154 0.139798,0.230285 0.02693,0.08813 0.02683,0.190919 -0.01724,0.303535 -0.04407,0.112615 -0.132418,0.234873 -0.227891,0.330346 -0.09548,0.09548 -0.197966,0.164097 -0.381574,0.191026 -0.183608,0.02693 -0.44825,0.0122 -0.636754,-0.01963 -0.188504,-0.03182 -0.301085,-0.08071 -0.399288,-0.110115 -0.09821,-0.02942 -0.182059,-0.03918 -0.223103,-0.04405 -0.04105,-0.0048 -0.156299,0.0719 -0.225976,0.09958 -0.06968,0.02768 -0.14778,0.04222 -0.262841,0.08139 -0.115061,0.03917 -0.266935,0.103014 -0.384446,0.164215 -0.11751,0.0612 -0.200739,0.11966 -0.237466,0.18576 -0.03672,0.0661 -0.02721,0.139825 0.03399,0.181451 0.0612,0.04162 0.1742,0.05119 0.328431,0.05362 0.154232,0.0025 0.349943,-0.0023 0.545789,-0.0072 -0.19095,0.04406 -0.381756,0.08797 -0.567812,0.09527 -0.186055,0.0073 -0.367591,-0.02188 -0.458176,-0.09288 -0.09059,-0.07099 -0.09019,-0.183821 -0.0057,-0.312153 0.08444,-0.128331 0.253358,-0.271943 0.334176,-0.340879 0.08082,-0.06893 0.551851,-0.176928 0.798576,-0.213528 0.246724,-0.0366 0.505864,-0.05637 0.687024,-0.105328 0.181161,-0.04896 0.284182,-0.127136 0.322686,-0.210177 0.03852,-0.08304 0.01283,-0.171153 0.0019,-0.208261 -0.01092,-0.03711 -0.314556,-0.04671 -0.468708,-0.03687 -0.154152,0.0098 -0.311082,0.0344 -0.445728,0.08091 -0.134646,0.04651 -0.247363,0.114872 -0.362423,0.180972 -0.11506,0.06609 -0.23262,0.129781 -0.364817,0.171397 -0.132196,0.04162 -0.27905,0.0612 -0.43328,0.06607 -0.154231,0.0049 -0.315445,-0.0047 -0.447643,-0.0072 -0.132199,-0.0024 -0.235165,0.0022 -0.382053,0.0316 -0.146888,0.02938 -0.338082,0.08355 -0.529032,0.137405 0.07344,-0.03917 0.14713,-0.07876 0.291566,-0.132617 0.144438,-0.05386 0.359832,-0.121967 0.563025,-0.148895 0.203192,-0.02689 0.393952,-0.01233 0.548183,-0.01963 0.15423,-0.0073 0.271813,-0.03706 0.346145,-0.08809 0.07433,-0.05103 0.105814,-0.123548 0.118733,-0.153683 0.01292,-0.03014 -0.09266,-0.135274 -0.113467,-0.156076 -0.02081,-0.02081 -0.206364,-0.01102 -0.312631,0.01628 -0.106268,0.0273 -0.225449,0.07678 -0.28247,0.10054 -0.05702,0.02377 -0.312382,0.04341 -0.461527,0.05314 -0.149146,0.0098 -0.320398,0.0198 -0.509882,0.0766 -0.189485,0.0568 -0.397054,0.160226 -0.497913,0.210656 -0.100864,0.05043 -0.543869,0.385578 -0.693248,0.510839 -0.149379,0.125263 -0.229944,0.210891 -0.266671,0.249914 -0.03673,0.03902 -0.352094,0.206762 -0.495519,0.255181 -0.143425,0.04842 -0.275686,0.06296 -0.344231,0.116818 -0.06856,0.05386 -0.0735,0.146719 -0.105327,0.244648 -0.03182,0.09792 -0.09077,0.200819 -0.164216,0.298747 -0.07344,0.09792 -0.161666,0.190996 -0.276725,0.257096 -0.11506,0.0661 -0.25682,0.105321 -0.398809,0.127351 -0.141988,0.02203 -0.284065,0.02706 -0.357635,0.08091 -0.0736,0.05385 -0.07869,0.156521 -0.08091,0.200602 -0.0022,0.04408 0.269681,0.286727 0.339442,0.349018 0.06977,0.06229 -0.006,0.128655 -0.05123,0.195814 -0.04528,0.06716 -0.09448,0.165018 -0.108679,0.26284 -0.01419,0.09782 0.0065,0.195639 0.01532,0.237466 0.0088,0.04183 0.118197,0.280573 0.183366,0.369126 0.06517,0.08856 0.143429,0.15259 0.238903,0.201559 0.09548,0.04896 0.208159,0.08302 0.320771,0.117297 -0.08813,-0.0049 -0.176192,-0.0098 -0.283907,-0.04165 -0.107714,-0.03183 -0.235085,-0.0905 -0.32077,-0.176185 -0.08569,-0.08568 -0.129461,-0.198462 -0.184324,-0.317898 -0.05486,-0.119437 -0.120514,-0.245707 -0.150331,-0.303057 -0.02982,-0.05734 -0.186013,-0.03767 -0.247521,0.01867 -0.0615,0.05634 -0.105687,0.159164 -0.112988,0.279119 -0.0073,0.119954 0.02186,0.257163 0.04165,0.384446 0.0198,0.127282 0.03003,0.24443 0.03447,0.295875 0.0045,0.05145 0.07361,0.536131 0.07086,0.732028 -0.0028,0.195896 -0.04189,0.352563 -0.117775,0.516585 -0.07589,0.164023 -0.188234,0.33577 -0.249435,0.458175 -0.06121,0.122406 -0.07109,0.19579 -0.03926,0.23986 0.03183,0.04407 0.105225,0.0585 0.217837,0.07565 0.112612,0.01714 0.264172,0.0369 0.376786,0.07852 0.112613,0.04162 0.18637,0.105135 0.245127,0.178578 0.05876,0.07344 0.102612,0.156525 0.08666,0.247999 -0.01596,0.09148 -0.09641,0.197368 -0.174749,0.300184 0.03427,-0.09303 0.07334,-0.198853 0.08809,-0.238902 0.01475,-0.04005 -0.05555,-0.250014 -0.130703,-0.299227 -0.07516,-0.0492 -0.192395,-0.04931 -0.305929,-0.02442 -0.113534,0.0249 -0.223272,0.07498 -0.275288,0.09862 -0.05202,0.02364 -0.171487,0.262209 -0.281034,0.331304 -0.109547,0.0691 -0.271823,0.09368 -0.35189,0.105807 -0.08006,0.01213 -0.170594,0.142898 -0.235551,0.226933 -0.06496,0.08403 -0.153111,0.191786 -0.209698,0.353327 -0.05659,0.161542 -0.08168,0.37689 -0.09336,0.477326 -0.01168,0.100438 0.226065,0.337714 0.273373,0.451473 0.04731,0.113759 0.0266,0.22665 0.01771,0.275767 -0.0089,0.04912 -0.08909,0.209482 -0.164215,0.241775 -0.07512,0.03229 -0.188279,0.02258 -0.244169,0.01771 -0.05588,-0.0049 -0.165497,0.04467 -0.191505,0.05649 -0.02601,0.01182 0.113727,0.191382 0.174748,0.287258 0.06102,0.09587 0.116796,0.202341 0.141714,0.249914 0.02492,0.04757 -0.079,0.255183 -0.10054,0.298269 -0.02154,0.04309 0.03794,0.743344 0.106285,1.095887 0.06834,0.352544 0.17578,0.714644 0.259011,1.045139 0.08323,0.330495 0.142185,0.629272 0.164215,0.945077 0.02208,0.315805 0.0075,0.649004 -0.0072,0.981942 -0.02448,-0.367211 -0.04934,-0.734698 -0.112988,-1.067641 -0.06365,-0.332943 -0.166143,-0.631631 -0.251829,-0.905818 -0.08568,-0.274186 -0.154603,-0.52364 -0.242733,-0.810066 -0.08813,-0.286427 -0.195527,-0.609708 -0.251829,-0.901031 -0.05627,-0.291324 -0.06112,-0.551084 -0.04836,-0.749264 0.01276,-0.198181 0.04284,-0.334981 0.05649,-0.396415 0.01366,-0.06143 0.07525,-0.378834 0.08857,-0.447643 0.01331,-0.06881 -0.03838,-0.347469 -0.04931,-0.406469 -0.01093,-0.059 0.02979,-0.416124 0.03878,-0.494562 0.009,-0.07844 0.25637,-0.424548 0.356678,-0.574036 0.100307,-0.149489 0.180856,-0.2803 0.217837,-0.3404 0.03699,-0.0601 0.08683,-0.280235 0.079,-0.353806 -0.0079,-0.07356 -0.04684,-0.117789 -0.115382,-0.07373 -0.06855,0.04406 -0.16646,0.176594 -0.259489,0.330825 -0.09303,0.154231 -0.181413,0.330269 -0.269543,0.50653 0.03427,-0.137092 0.06849,-0.274313 0.155119,-0.489295 0.08663,-0.214982 0.225873,-0.507801 0.292524,-0.648244 0.06665,-0.140443 0.338985,-0.02347 0.450037,-0.04022 0.111052,-0.01676 0.19409,-0.109973 0.250392,-0.310717 0.05631,-0.200745 0.08596,-0.509144 0.13166,-0.744476 0.0457,-0.23533 0.107777,-0.39748 0.141235,-0.484986 0.03346,-0.08751 0.093,-0.405663 0.107243,-0.481635 0.01425,-0.07597 -0.135179,-0.294518 -0.156077,-0.407906 -0.0209,-0.113387 0.0087,-0.235855 0.0857,-0.38684 0.07704,-0.150985 0.201541,-0.330737 0.260446,-0.415566 0.05891,-0.08483 0.05889,-0.373515 0.05889,-0.434716 0,-0.0612 0.03934,-0.391513 0.114424,-0.567334 0.07508,-0.17582 0.20622,-0.36937 0.389713,-0.511318 0.183493,-0.141949 0.419107,-0.232261 0.604677,-0.311196 0.185571,-0.07893 0.321528,-0.146401 0.393543,-0.182408 0.07201,-0.03601 0.234397,-0.199163 0.322686,-0.266671 0.08828,-0.06751 0.178353,-0.115668 0.230285,-0.181451 0.05193,-0.06578 0.0656,-0.149039 0.02059,-0.204431 -0.04501,-0.05537 -0.148661,-0.08312 -0.245605,-0.05889 -0.09694,0.02423 -0.186711,0.1005 -0.276724,0.176663 0.235423,-0.276968 0.470397,-0.553912 0.732027,-0.774638 0.261631,-0.220725 0.549641,-0.385347 0.698036,-0.470144 0.148394,-0.0848 1.184927,-0.457619 1.705352,-0.582654 0.520425,-0.125035 1.039535,-0.187602 1.558851,-0.249914 -0.373907,0.08309 -0.749125,0.166357 -1.014977,0.283906 -0.265852,0.11755 -0.425208,0.269899 -0.452909,0.408384 -0.0277,0.138487 0.07611,0.263278 0.256138,0.294439 0.18003,0.03116 0.436138,-0.03092 0.749263,-0.173791 0.313125,-0.142871 0.683256,-0.366472 0.863688,-0.475411 0.180431,-0.10894 1.123734,-0.289255 1.604333,-0.275288 0.480599,0.01397 0.972139,0.131542 1.44299,0.180014 0.47085,0.04847 0.920886,0.0277 1.206481,-0.03256 0.285597,-0.06026 0.406551,-0.159721 0.462006,-0.205389 0.0555,-0.04567 0.01526,-0.288118 0.0043,-0.353806 -0.01095,-0.06569 -0.257248,-0.22973 -0.473496,-0.289651 -0.216249,-0.05992 -0.520843,-0.09462 -1.105941,-0.101498 -0.585098,-0.0069 -1.450689,0.01357 -1.883452,0.02394 -0.432763,0.01039 -0.432924,0.01057 0.169482,-0.02059 0.602406,-0.03115 1.807436,-0.0938 2.596808,-0.07995 z m -1.128444,9.596794 a 1.8801233,1.8801233 0 0 1 1.880101,1.8801 1.8801233,1.8801233 0 0 1 -1.880101,1.880101 1.8801233,1.8801233 0 0 1 -1.8801,-1.880101 1.8801233,1.8801233 0 0 1 1.8801,-1.8801 z" /></g></svg>

`

export default class AudioModal extends MediaModal {
  constructor() {
    super()
  }

  async connectedCallback() {
    await super.connectedCallback();
  }

  disconnectedCallback() {
    this._cleanup();
  }

  async open() {
    super.open?.();

    this.$modal.animate(
      [
        { opacity: 0 },
        { opacity: 1 }
      ],
      {
        duration: 250,
        easing: "ease-out"
      }
    )

    this.$coverImage
      .animate(
        [
          { opacity: 0, transform: "scale(0) rotate(-15deg)" },
          { opacity: 1, transform: "scale(1) rotate(0deg)" }
        ],
        {
          duration: 750,
          easing: "cubic-bezier(1, 0, 0, 1)",
          fill: 'forwards'
        }
      )
      .onfinish = () => {
        this.$modalAudio.currentTime = 0;
        // this.$modalAudio.play();
        requestAnimationFrame(() => {
          this.$vinyl.style.animationPlayState = 'running';
        })
      }

  }

  close() {
    const audioAnim = this.$modalAudio.animate(
      [
        { opacity: 1, transform: "scale(1)" },
        { opacity: 0, transform: "scale(0.85)" }
      ],
      { duration: 200, easing: "ease-in" }
    );

    const modalAnim = this.$modal.animate(
      [{ opacity: 1 }, { opacity: 0 }],
      { duration: 200, easing: "ease-in" }
    );

    audioAnim.onfinish = () => this.$modalAudio.pause();

    modalAnim.onfinish = () => super.close?.();
  }

  async _preRender() {
    this.cover = this.getAttribute('cover');
    this.size = this.getAttribute('size') || '200px';
    this.$thumb.style.setProperty('--cover-size', this.size);
  }

  async _render() {
    const [html, css] = await Promise.all([loadExternalResource('./template.html', import.meta.url), loadExternalResource('./style.css', import.meta.url)]);

    this.$thumb.innerHTML = `<img src="${this.cover}" alt="Audio cover"></img>`;
    this.$modal.innerHTML = applyTemplate(html, {
      src: this.src,
      cover: this.cover
    });

    const baseSheet = new CSSStyleSheet();
    baseSheet.replaceSync(css);

    this.shadowRoot.adoptedStyleSheets = [
      ...this.shadowRoot.adoptedStyleSheets,
      baseSheet
    ];
  }

  _cacheElements() {
    this.$thumbAudio = this.$thumb.querySelector('audio');
    this.$modalAudio = this.$modal.querySelector('audio');
    this.$vinyl = this.$modal.querySelector('.image-container');
    this.$coverImage = this.$modal.querySelector('.image-container img');
  }

  _bindEvents() {
    this.$coverImage.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      if (this.$modalAudio.paused) {
        this.$modalAudio.play();
        this.$vinyl.style.animationPlayState = 'running';
      } else {
        this.$modalAudio.pause();
        this.$vinyl.style.animationPlayState = 'paused';
      }
    });
  }

  _afterInit() {
    this.$coverImage.style.maskImage = `url("${svgToDataUrl(svg)}")`;
    this.$coverImage.style.webkitMaskImage = `url("${svgToDataUrl(svg)}")`;
  }

  _cleanup() { }
}